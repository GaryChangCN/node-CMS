!function(){var t={errorCount:0,chinese:!~window.location.href.indexOf("language=en"),bindEvent:function(){var t=this;$(".input-field .input").focus(function(t){t.preventDefault(),$(this).next("label").addClass("active")}),$(".input-field .input").blur(function(t){t.preventDefault(),$(this).val()||$(this).next("label").removeClass("active")}),$(".caret").click(function(e){e.preventDefault(),$(this).parent().find("input").focus();var n=$(this).parent().find("ul");n.show("400",function(){t.listenClick2hide(this)})}),$(".dropdown-content li").click(function(t){t.preventDefault();var e=$(this).text(),n=$(this).parent().parent();n.find("input").val(e),$(this).parent().hide()}),$(".select-dropdown-readonly").click(function(e){e.preventDefault();var n=($(this).parent().find("span"),$(this).parent().find("ul"));n.show("400",function(){t.listenClick2hide(this)})}),$(".submit-quote").click(function(e){console.log(e),e.preventDefault(),t.sendQuote()})},listenClick2hide:function(t){$(document).click(function(e){e.target!=t&&($(t).hide(),$(document).off())})},sendQuote:function(){if(!$("#name").val())return alert("请填写完整你的名字！"),!1;if(!$("#email").val())return alert("请填写你的邮箱！"),!1;if(!$("#country").val())return alert("请选择你的国家或地区！"),!1;if(!$("#currency").val())return alert("请选择你希望的报价币种"),!1;if(!$("#phone").val())return alert("请填写你的电话！"),!1;if($("#quote-list").children(".product-item").length<=0)return alert("请选择你要咨询的商品！"),!1;$(".submit-quote").prop("disabled",!0),$(".submit-quote").text().indexOf("提交")?$(".submit-quote").text("提交中……"):$(".submit-quote").text("Loading……");for(var t="客户的国家或地区："+$("#country").val()+"；客户的邮箱："+$("#email").val()+"；客户的其他联系方式："+$("#other").val()+"客户的备注信息："+$("#remarks").val(),e={"CNY 人民币":"RMB","MYR 马来西亚令吉":"RM","HKD 港币":"HKD","USD 美元":"USD"},n={customerName:$("#name").val(),customerContact:$("#phone").val(),money:e[$("#currency").val().trim()],customerBoard:t},i=$("#quote-list").children(".product"),o=$("#quote-list").children(".combo"),r=JSON.parse(localStorage.getItem("quote")),u=[],a={},l=[],c=0;c<r.combo.length;c++)a[r.combo[c].englishName]=r.combo[c];for(var s=0;s<o.length;s++)for(var f=a[$(o[s]).attr("combo")].product,d=0;d<f.length;d++)l.push({_id:f[d],count:$(o[s]).find("input[type=number]").val()});console.log(l);for(var p=0;p<i.length;p++)u.push({_id:$(i[p]).attr("product"),count:$(i[p]).find("input[type=number]").val()});n.customerProduct=JSON.stringify(u.concat(l)),console.log(n),$.ajax({type:"post",url:"/api/order",data:n,dataType:"json",complete:function(){console.log("complete")},success:function(t){n.err?alert("Error！"):(alert("Success！"),$(".submit-quote").prop("disabled",!1),$(".submit-quote").text().indexOf("提交")?$(".submit-quote").text("提交"):$(".submit-quote").text("Submit"))},error:function(t){alert("Error！")}})},init:function(){var t=this;t.bindEvent()}};t.init()}();